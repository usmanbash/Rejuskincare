<section class="sc_seen">
  <div class="container">
    <div class="row">
      {% if section.settings.heading != blank %}
        <h4 class="text-center">{{ section.settings.heading }}</h4>
      {% endif %}

      {%- if section.blocks.size > 0 -%}
        <div class="swiper swiper-{{ section.id }}">
          <div class="swiper-wrapper">
            {% for block in section.blocks %}
              <div class="swiper-slide" {{ block.shopify_attributes }}>
                {% if block.settings.link != blank %}
                  <a href="{{ block.settings.link }}" target="_blank" rel="noopener">
                {% endif %}
                {% if block.settings.image != blank %}
                  {{ block.settings.image | image_url: width: 300 | image_tag: 
                    loading: 'lazy',
                    class: 'img-fluid',
                    alt: block.settings.image.alt | default: section.settings.heading
                  }}
                {% endif %}
                {% if block.settings.link != blank %}
                  </a>
                {% endif %}
              </div>
            {% endfor %}
          </div>
        </div>
      {%- endif -%}
    </div>
  </div>
</section>
<style>
.sc_seen {
  padding: 50px 0px;
}

.sc_seen h4 {
  margin: 0 0 24px;
}

.sc_seen .swiper {
  width: 100%;
  overflow: hidden;
}

.sc_seen .swiper-slide {
  display: flex;
  align-items: center;
  justify-content: center;
  height: auto;
}

.sc_seen .swiper-slide a {
  display: block;
  width: 100%;
}

.sc_seen .swiper-slide img {
  width: 100%;
  height: auto;
  object-fit: contain;
  max-height: 80px;
}

{% unless section.settings.enable_desktop_slider %}
@media screen and (min-width: 750px) {
  .sc_seen .swiper {
    overflow: visible;
  }
  
  .sc_seen .swiper-wrapper {
    display: flex;
    flex-wrap: nowrap;
    justify-content: center;
    gap: 60px;
    transform: none !important;
  }
  
  .sc_seen .swiper-slide {
    width: auto !important;
    max-width: 160px;
    flex-shrink: 0;
  }
}
{% endunless %}

@media screen and (max-width: 749px) {
  .sc_seen .swiper-slide img {
    max-height: 60px;
  }
}
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css">
<script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var swiperInstance = null;
    
    function initSlider() {
      var isDesktop = window.innerWidth >= 750;
      var desktopSliderEnabled = {{ section.settings.enable_desktop_slider }};
      
      // Destroy existing instance if it exists
      if (swiperInstance) {
        swiperInstance.destroy(true, true);
        swiperInstance = null;
      }
      
      // Only initialize slider if:
      // - On mobile (always) OR
      // - On desktop AND desktop slider is enabled
      if (!isDesktop || desktopSliderEnabled) {
        swiperInstance = new Swiper('.swiper-{{ section.id }}', {
          slidesPerView: {{ section.settings.slides_mobile | default: 2 }},
          spaceBetween: 20,
          loop: true,
          autoplay: {
            delay: 3000,
            disableOnInteraction: false,
          },
          breakpoints: {
            750: {
              slidesPerView: {{ section.settings.slides_desktop | default: 5 }},
              spaceBetween: 40,
            }
          }
        });
      }
    }
    
    // Initialize on load
    initSlider();
    
    // Reinitialize on resize
    var resizeTimer;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(initSlider, 250);
    });
  });
</script>
{% schema %}
{
  "name": "As Seen In",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "As Seen in"
    },
    {
      "type": "checkbox",
      "id": "enable_desktop_slider",
      "label": "Enable slider on desktop",
      "default": true,
      "info": "Mobile always shows slider"
    },
    {
      "type": "range",
      "id": "slides_desktop",
      "min": 1,
      "max": 8,
      "step": 1,
      "label": "Number of slides on desktop",
      "default": 5
    },
    {
      "type": "range",
      "id": "slides_mobile",
      "min": 1,
      "max": 4,
      "step": 1,
      "label": "Number of slides on mobile",
      "default": 2
    }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "Logo",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Logo Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link (Optional)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "As Seen In",
      "category": "custom"
    }
  ]
}
{% endschema %}